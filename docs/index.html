<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Reverse SHA-1</title>
    <style>
      @import url('https://fonts.googleapis.com/css?family=Open+Sans:400,700');
      @import url('https://fonts.googleapis.com/css?family=Merriweather:400,700');

      body {
        background-color: white;
        font-family: "Merriweather", serif;
        padding: 5px 25px;
        font-size: 18px;
        margin: auto;
        color: #444;
        max-width: 700px;
        text-align: justify;
      }

      h1 {
        font-family: "Open Sans", sans-serif;
        font-size: 32px;
      }
      form input {
        font-size: 1.2em;
      }
      #hash {
        margin: auto;
        width: 72%;
        max-width: 550px;

      }
      #submit {
        width: 17%;
        padding: 0;
      }
      #response {
        margin-top: 25px;
        font-size: 1.3em;
        padding: 15px;
        background: #ddd;
        border-radius: 5px;
        border: 2px solid #000;
        white-space: pre-wrap;
      }
      #response.error   {background: #fdd;}
      #response.success {background: #dfd;}
    </style>
  </head>
  <body>
    <h1>SHA1 database</h1>
    <p>We have a database of over 1 million <strong><a href="https://en.wikipedia.org/wiki/SHA-1">SHA1</a></strong> hashes of common passwords.</p>

    <form action="#">
      <input id="hash"/>
      <input id="submit" type="submit" value="GO" />
    </form>
    
    <pre id="response">Enter a hash above, and if it is in our database, the corresponding password will appear here.</pre>
    <script>
const BASE = "https://api.github.com/repos/lovasoa/sha_hashes/contents/hashes/sha1";
const form = document.querySelector("form");
const response = document.querySelector("#response");

function onsubmit(evt) {
  evt.preventDefault();
  var hash = form.elements.hash.value;
  var folders = hash.substring(0,4).split("").join("/");
  var url = BASE + '/' + folders + '/' + hash;
  response.textContent = "Loading...";
  fetch(url, {
    headers: {
      "Accept": "application/vnd.github.VERSION.raw"
    }
  }).then(r => r.ok ? r.text() : r.json().then(x=>Promise.reject(x)))
    .then(handle).catch(error);
}

function handle(resp) {
  response.className = "success";
  response.textContent = resp;
}

function error(resp) {
  response.className = "error";
  response.textContent = resp.message || JSON.stringify(resp);
  console.error(resp);
}
      
form.addEventListener("submit", onsubmit);
    </script>
  </body>
</html>
